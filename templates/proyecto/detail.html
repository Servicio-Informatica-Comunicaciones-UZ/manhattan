{% extends 'base.html' %}
{% load custom_tags %}
{% block content %}
<div class="container-blanco">
    <div class='alert alert-info'>
        <i class="fas fa-info-circle"></i>
        <div>Puede editar su solicitud tantas veces como desee.</br>
            Cuando esté satisfecho, pulse el botón «Presentar».
            Una vez haya presentado la solicitud, ya no podrá modificarla.
        </div>
    </div>

    <h1>{{ proyecto.titulo }}</h1> {# DetailView proporciona el objeto de contexto `proyecto` #}
    <hr><br>

    <p><strong>Convocatoria</strong>: {{ proyecto.convocatoria_id }}</p>

    <p><strong>Programa</strong>: {{ proyecto.programa.nombre_corto }} ({{ proyecto.programa.nombre_largo }})</p>

    {% if proyecto.linea %}
    <p><strong>Línea</strong>: {{ proyecto.linea.nombre }}</p>
    {% endif %}

    {% if proyecto.centro %}
    <p><strong>Centro</strong>: {{ proyecto.centro.nombre }}</p>
    {% endif %}

    {% if proyecto.estudio %}
    <p><strong>Estudio</strong>: {{ proyecto.estudio.nombre }}</p>
    {% endif %}

    {% if coordinador_principal %}
    <p><strong>{{ coordinador_principal.get_cargo }}</strong>: {{ coordinador_principal.usuario.get_full_name }}</p>
    {% endif %}

    {% if coordinador %}
    <p><strong>{{ coordinador.get_cargo }}</strong>: {{ coordinador.usuario.get_full_name }}</p>
    {% endif %}

    {# TODO: filtro para HTML procedente de procesador de textos #}
    <h3>Descripción</h3>
    <p>{{ proyecto.descripcion|safe }}</p>

    {% for campo in campos %}
    <h3>{{ proyecto|get_attr_verbose_name:campo }}</h3>
    <p>{{ proyecto|get_obj_attr:campo|default:""|safe }}</p>
    <p><a href="{% url 'proyecto_update_field' proyecto.id campo %}" class="btn btn-info btn-sm">
            <i class="fas fa-pencil-alt" aria-hidden="true"></i> &nbsp; Editar
        </a></p>
    {% endfor %}

    <h3>{{ proyecto|get_attr_verbose_name:"financiacion"}}</h3>
    <p>{{ proyecto.financiacion|default:""|safe }}</p>

    <h3>{{ proyecto|get_attr_verbose_name:"ayuda"}}</h3>
    <p>{{ proyecto.ayuda|default:"" }}</p>

</div>
{% endblock content %}